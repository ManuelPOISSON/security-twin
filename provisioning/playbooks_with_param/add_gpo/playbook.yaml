---
- name: Configure local user rights via PowerShell
  hosts: "{{ target }}"
  gather_facts: no
  vars:
    # the Python caller should set this dict
    user_rights_mapping: {}

  tasks:
    - name: Generate PowerShell script from template
      ansible.windows.win_template:
        src: Set-UserRights.ps1.j2
        dest: C:\Windows\Temp\Set-UserRights.ps1

    - name: Execute the PowerShell script
      ansible.windows.win_shell: |
        powershell.exe -ExecutionPolicy Bypass -File C:\Windows\Temp\Set-UserRights.ps1
